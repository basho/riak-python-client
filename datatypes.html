

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Data Types &mdash; Riak Python Client 2.1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
    <link rel="top" title="Riak Python Client 2.1.0 documentation" href="index.html"/>
        <link rel="next" title="Query Methods" href="query.html"/>
        <link rel="prev" title="Values &amp; Objects" href="object.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> Riak Python Client</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="client.html">Client &amp; Connections</a><ul>
<li class="toctree-l2"><a class="reference internal" href="client.html#client-objects">Client objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="client.html#client-level-operations">Client-level Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="client.html#accessing-bucket-types-and-buckets">Accessing Bucket Types and Buckets</a></li>
<li class="toctree-l2"><a class="reference internal" href="client.html#bucket-type-operations">Bucket Type Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="client.html#bucket-operations">Bucket Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="client.html#key-level-operations">Key-level Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="client.html#query-operations">Query Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="client.html#search-maintenance-operations">Search Maintenance Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="client.html#serialization">Serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="client.html#deprecated-features">Deprecated Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bucket.html">Buckets &amp; Bucket Types</a><ul>
<li class="toctree-l2"><a class="reference internal" href="bucket.html#bucket-objects">Bucket objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="bucket.html#bucket-properties">Bucket properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="bucket.html#working-with-keys">Working with keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="bucket.html#query-operations">Query operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="bucket.html#serialization">Serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="bucket.html#listing-keys">Listing keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="bucket.html#bucket-type-objects">Bucket Type objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="bucket.html#bucket-type-properties">Bucket Type properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="bucket.html#listing-buckets">Listing buckets</a></li>
<li class="toctree-l2"><a class="reference internal" href="bucket.html#deprecated-features">Deprecated Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="object.html">Values &amp; Objects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="object.html#riakobject">RiakObject</a></li>
<li class="toctree-l2"><a class="reference internal" href="object.html#persistence">Persistence</a></li>
<li class="toctree-l2"><a class="reference internal" href="object.html#value-and-metadata">Value and Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="object.html#siblings">Siblings</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Data Types</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#sending-operations">Sending Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#context-and-observed-remove">Context and Observed-Remove</a></li>
<li class="toctree-l2"><a class="reference internal" href="#datatype-abstract-class">Datatype abstract class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#counter">Counter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#set">Set</a></li>
<li class="toctree-l2"><a class="reference internal" href="#map">Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="#map-only-datatypes">Map-only datatypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#register">Register</a></li>
<li class="toctree-l2"><a class="reference internal" href="#flag">Flag</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="query.html">Query Methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="query.html#secondary-indexes">Secondary Indexes</a></li>
<li class="toctree-l2"><a class="reference internal" href="query.html#mapreduce">MapReduce</a></li>
<li class="toctree-l2"><a class="reference internal" href="query.html#riak-search-2-0-yokozuna">Riak Search 2.0 (Yokozuna)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security</a><ul>
<li class="toctree-l2"><a class="reference internal" href="security.html#server-configuration">Server Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html#client-configuration">Client Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html#authentication-types">Authentication Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html#additional-options">Additional options</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html#securitycreds-object">SecurityCreds object</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced Usage &amp; Internals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#connection-pool">Connection pool</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#retry-logic">Retry logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#multiget">Multiget</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#datatypes">Datatypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#transports">Transports</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#utilities">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#module-commands">distutils commands</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Riak Python Client</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Data Types</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/datatypes.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="data-types">
<span id="datatypes"></span><h1>Data Types<a class="headerlink" href="#data-types" title="Permalink to this headline">¶</a></h1>
<p>Traditionally all data stored in Riak was an opaque binary type. Then
in version 1.4 came the introduction of a <a class="reference internal" href="client.html#legacy-counters"><em>counter</em></a>, the first Convergent Data Type supported in Riak.
In Riak 2.0, several additional Data Types were introduced. Riak
&#8220;knows&#8221; about these data types, and conflicting writes to them will
converge automatically without presenting <a class="reference internal" href="object.html#siblings"><em>sibling values</em></a> to the user.</p>
<p>Here is the list of current Data Types:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#riak.datatypes.Counter" title="riak.datatypes.Counter"><tt class="xref py py-class docutils literal"><span class="pre">Counter</span></tt></a> increments or decrements
integer values</li>
<li><a class="reference internal" href="#riak.datatypes.Set" title="riak.datatypes.Set"><tt class="xref py py-class docutils literal"><span class="pre">Set</span></tt></a> allows you to store multiple
distinct opaque binary values against a key</li>
<li><a class="reference internal" href="#riak.datatypes.Map" title="riak.datatypes.Map"><tt class="xref py py-class docutils literal"><span class="pre">Map</span></tt></a> is a nested, recursive
struct, or associative array. Think of it as a container for
composing ad hoc data structures from multiple Data Types.
Inside a map you may store sets, counters, flags,
registers, and even other maps</li>
<li><a class="reference internal" href="#riak.datatypes.Register" title="riak.datatypes.Register"><tt class="xref py py-class docutils literal"><span class="pre">Register</span></tt></a> stores binaries
accoring to last-write-wins logic within
<a class="reference internal" href="#riak.datatypes.Map" title="riak.datatypes.Map"><tt class="xref py py-class docutils literal"><span class="pre">Map</span></tt></a></li>
<li><a class="reference internal" href="#riak.datatypes.Flag" title="riak.datatypes.Flag"><tt class="xref py py-class docutils literal"><span class="pre">Flag</span></tt></a> is similar to a boolean
and also must be within <a class="reference internal" href="#riak.datatypes.Map" title="riak.datatypes.Map"><tt class="xref py py-class docutils literal"><span class="pre">Map</span></tt></a></li>
</ul>
</div></blockquote>
<p>All Data Types must be stored in buckets bearing a
<a class="reference internal" href="bucket.html#riak.bucket.BucketType" title="riak.bucket.BucketType"><tt class="xref py py-class docutils literal"><span class="pre">BucketType</span></tt></a> that sets the
<a class="reference internal" href="bucket.html#riak.bucket.BucketType.datatype" title="riak.bucket.BucketType.datatype"><tt class="xref py py-attr docutils literal"><span class="pre">datatype</span></tt></a> property to one of
<tt class="docutils literal"><span class="pre">&quot;counter&quot;</span></tt>, <tt class="docutils literal"><span class="pre">&quot;set&quot;</span></tt>, or <tt class="docutils literal"><span class="pre">&quot;map&quot;</span></tt>. Note that the bucket must have
the <tt class="docutils literal"><span class="pre">allow_mult</span></tt> property set to <tt class="docutils literal"><span class="pre">true</span></tt>.</p>
<p>These Data Types are stored just like <a class="reference internal" href="object.html#riak.riak_object.RiakObject" title="riak.riak_object.RiakObject"><tt class="xref py py-class docutils literal"><span class="pre">RiakObjects</span></tt></a>, so size constraints that apply to
normal Riak values apply to Riak Data Types too.</p>
<p>An in-depth discussion of Data Types, also known as CRDTs,
can be found at <a class="reference external" href="http://docs.basho.com/riak/2.0.0/theory/concepts/crdts/">Data Types</a>.</p>
<p>Examples of using Data Types can be found at
<a class="reference external" href="http://docs.basho.com/riak/2.0.0/dev/using/data-types/">Using Data Types</a>.</p>
<div class="section" id="sending-operations">
<h2>Sending Operations<a class="headerlink" href="#sending-operations" title="Permalink to this headline">¶</a></h2>
<p>Riak Data Types provide a further departure from Riak&#8217;s usual operation,
in that the API is operation-based. Rather than fetching the data structure,
reconciling conflicts, mutating the result, and writing it back, you instead
tell Riak what operations to perform on the Data Type. Here are some example
operations:</p>
<blockquote>
<div><ul class="simple">
<li>increment a <a class="reference internal" href="#riak.datatypes.Counter" title="riak.datatypes.Counter"><tt class="xref py py-class docutils literal"><span class="pre">Counter</span></tt></a> by <tt class="docutils literal"><span class="pre">10</span></tt></li>
<li>add <tt class="docutils literal"><span class="pre">'joe'</span></tt> to a <a class="reference internal" href="#riak.datatypes.Set" title="riak.datatypes.Set"><tt class="xref py py-class docutils literal"><span class="pre">Set</span></tt></a></li>
<li>remove the <a class="reference internal" href="#riak.datatypes.Set" title="riak.datatypes.Set"><tt class="xref py py-class docutils literal"><span class="pre">Set</span></tt></a> field called <tt class="docutils literal"><span class="pre">'friends'</span></tt> from a <a class="reference internal" href="#riak.datatypes.Map" title="riak.datatypes.Map"><tt class="xref py py-class docutils literal"><span class="pre">Map</span></tt></a></li>
<li>enable the prepay <a class="reference internal" href="#riak.datatypes.Flag" title="riak.datatypes.Flag"><tt class="xref py py-class docutils literal"><span class="pre">Flag</span></tt></a> in a <a class="reference internal" href="#riak.datatypes.Map" title="riak.datatypes.Map"><tt class="xref py py-class docutils literal"><span class="pre">Map</span></tt></a></li>
</ul>
</div></blockquote>
<p>Datatypes can be fetched and created just like
<a class="reference internal" href="object.html#riak.riak_object.RiakObject" title="riak.riak_object.RiakObject"><tt class="xref py py-class docutils literal"><span class="pre">RiakObject</span></tt></a> instances, using
<a class="reference internal" href="bucket.html#riak.bucket.RiakBucket.get" title="riak.bucket.RiakBucket.get"><tt class="xref py py-meth docutils literal"><span class="pre">RiakBucket.get</span></tt></a> and
<a class="reference internal" href="bucket.html#riak.bucket.RiakBucket.new" title="riak.bucket.RiakBucket.new"><tt class="xref py py-meth docutils literal"><span class="pre">RiakBucket.new</span></tt></a>, except that the
bucket must belong to a bucket-type that has a valid datatype
property. If we have a bucket-type named &#8220;social-graph&#8221; that has the
datatype <cite>&#8220;set&#8221;</cite>, we would fetch a <a class="reference internal" href="#riak.datatypes.Set" title="riak.datatypes.Set"><tt class="xref py py-class docutils literal"><span class="pre">Set</span></tt></a> like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">graph</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">bucket_type</span><span class="p">(</span><span class="s">&#39;social-graph&#39;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">datatype</span>  <span class="c"># =&gt; &#39;set&#39;</span>
<span class="n">myfollowers</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">bucket</span><span class="p">(</span><span class="s">&#39;followers&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;seancribbs&#39;</span><span class="p">)</span>
<span class="c"># =&gt; a Set datatype</span>
</pre></div>
</div>
<p>Once we have a datatype, we can stage operations against it and then
send those operations to Riak:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">myfollowers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;javajolt&#39;</span><span class="p">)</span>
<span class="n">myfollowers</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="s">&#39;roach&#39;</span><span class="p">)</span>
<span class="n">myfollowers</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<p>While this looks in code very similar to manipulating
<a class="reference internal" href="object.html#riak.riak_object.RiakObject" title="riak.riak_object.RiakObject"><tt class="xref py py-class docutils literal"><span class="pre">RiakObject</span></tt></a> instances, only mutations are
enqueued locally, not the new value.</p>
</div>
<div class="section" id="context-and-observed-remove">
<h2>Context and Observed-Remove<a class="headerlink" href="#context-and-observed-remove" title="Permalink to this headline">¶</a></h2>
<p>In order for Riak Data Types to behave well, you must have an opaque
context received from a read when you:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#riak.datatypes.Flag.disable" title="riak.datatypes.Flag.disable"><tt class="xref py py-meth docutils literal"><span class="pre">disable</span></tt></a> a <a class="reference internal" href="#riak.datatypes.Flag" title="riak.datatypes.Flag"><tt class="xref py py-class docutils literal"><span class="pre">Flag</span></tt></a>
(set it to <tt class="docutils literal"><span class="pre">false</span></tt>)</li>
<li>remove a field from a <a class="reference internal" href="#riak.datatypes.Map" title="riak.datatypes.Map"><tt class="xref py py-class docutils literal"><span class="pre">Map</span></tt></a></li>
<li><a class="reference internal" href="#riak.datatypes.Set.discard" title="riak.datatypes.Set.discard"><tt class="xref py py-meth docutils literal"><span class="pre">remove</span></tt></a> an element from a <a class="reference internal" href="#riak.datatypes.Set" title="riak.datatypes.Set"><tt class="xref py py-class docutils literal"><span class="pre">Set</span></tt></a></li>
</ul>
</div></blockquote>
<p>The basic rule is &#8220;you cannot remove something you haven&#8217;t seen&#8221;, and
the context tells Riak what you&#8217;ve actually seen, similar to the
<a class="reference internal" href="object.html#vclock"><em>Vector clock</em></a> on <a class="reference internal" href="object.html#riak.riak_object.RiakObject" title="riak.riak_object.RiakObject"><tt class="xref py py-class docutils literal"><span class="pre">RiakObject</span></tt></a>. The Python
client handles opaque contexts for you transparently as long as you
fetch before performing one of these actions.</p>
</div>
<div class="section" id="datatype-abstract-class">
<h2>Datatype abstract class<a class="headerlink" href="#datatype-abstract-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="riak.datatypes.Datatype">
<em class="property">class </em><tt class="descclassname">riak.datatypes.</tt><tt class="descname">Datatype</tt><big>(</big><em>bucket=None</em>, <em>key=None</em>, <em>value=None</em>, <em>context=None</em><big>)</big><a class="headerlink" href="#riak.datatypes.Datatype" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for all convergent datatype wrappers. You will not use
this class directly, but it does define some methods are common to
all datatype wrappers.</p>
<dl class="attribute">
<dt id="riak.datatypes.Datatype.value">
<tt class="descname">value</tt><a class="headerlink" href="#riak.datatypes.Datatype.value" title="Permalink to this definition">¶</a></dt>
<dd><p>The pure, immutable value of this datatype, as a Python value,
which is unique for each datatype.</p>
<p><strong>NB</strong>: Do not use this property to mutate data, as it will not
have any effect. Use the methods of the individual type to effect
changes. This value is guaranteed to be independent of any internal
data representation.</p>
</dd></dl>

<dl class="attribute">
<dt id="riak.datatypes.Datatype.context">
<tt class="descname">context</tt><a class="headerlink" href="#riak.datatypes.Datatype.context" title="Permalink to this definition">¶</a></dt>
<dd><p>The opaque context for this type, if it was previously fetched.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="riak.datatypes.Datatype.modified">
<tt class="descname">modified</tt><a class="headerlink" href="#riak.datatypes.Datatype.modified" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether this datatype has staged local modifications.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<div class="section" id="persistence-methods">
<h3>Persistence methods<a class="headerlink" href="#persistence-methods" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="riak.datatypes.Datatype.reload">
<tt class="descclassname">Datatype.</tt><tt class="descname">reload</tt><big>(</big><em>**params</em><big>)</big><a class="headerlink" href="#riak.datatypes.Datatype.reload" title="Permalink to this definition">¶</a></dt>
<dd><p>Reloads the datatype from Riak.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r</strong> (<em>integer, string, None</em>) &#8211; the read quorum</li>
<li><strong>pr</strong> (<em>integer, string, None</em>) &#8211; the primary read quorum</li>
<li><strong>basic_quorum</strong> (<em>bool</em>) &#8211; whether to use the &#8220;basic quorum&#8221; policy
for not-founds</li>
<li><strong>notfound_ok</strong> (<em>bool</em>) &#8211; whether to treat not-found responses as successful</li>
<li><strong>timeout</strong> (<em>int</em>) &#8211; a timeout value in milliseconds</li>
<li><strong>include_context</strong> (<em>bool</em>) &#8211; whether to return the opaque context
as well as the value, which is useful for removal operations
on sets and maps</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#riak.datatypes.Datatype" title="riak.datatypes.Datatype"><tt class="xref py py-class docutils literal"><span class="pre">Datatype</span></tt></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="riak.datatypes.Datatype.update">
<tt class="descclassname">Datatype.</tt><tt class="descname">update</tt><big>(</big><em>**params</em><big>)</big><a class="headerlink" href="#riak.datatypes.Datatype.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends locally staged mutations to Riak.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>w</strong> (<em>integer</em>) &#8211; W-value, wait for this many partitions to respond
before returning to client.</li>
<li><strong>dw</strong> (<em>integer</em>) &#8211; DW-value, wait for this many partitions to
confirm the write before returning to client.</li>
<li><strong>pw</strong> (<em>integer</em>) &#8211; PW-value, require this many primary partitions to
be available before performing the put</li>
<li><strong>return_body</strong> (<em>bool</em>) &#8211; if the newly stored object should be
retrieved, defaults to True</li>
<li><strong>include_context</strong> (<em>bool</em>) &#8211; whether to return the new opaque
context when <cite>return_body</cite> is <cite>True</cite></li>
<li><strong>timeout</strong> (<em>int</em>) &#8211; a timeout value in milliseconds</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">a subclass of <a class="reference internal" href="#riak.datatypes.Datatype" title="riak.datatypes.Datatype"><tt class="xref py py-class docutils literal"><span class="pre">Datatype</span></tt></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="riak.datatypes.Datatype.store">
<tt class="descclassname">Datatype.</tt><tt class="descname">store</tt><big>(</big><em>**params</em><big>)</big><a class="headerlink" href="#riak.datatypes.Datatype.store" title="Permalink to this definition">¶</a></dt>
<dd><p>This is an alias for <a class="reference internal" href="#riak.datatypes.Datatype.update" title="riak.datatypes.Datatype.update"><tt class="xref py py-meth docutils literal"><span class="pre">update()</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="riak.datatypes.Datatype.clear">
<tt class="descclassname">Datatype.</tt><tt class="descname">clear</tt><big>(</big><big>)</big><a class="headerlink" href="#riak.datatypes.Datatype.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes all locally staged mutations.</p>
</dd></dl>

</div>
</div>
<div class="section" id="counter">
<h2>Counter<a class="headerlink" href="#counter" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="riak.datatypes.Counter">
<em class="property">class </em><tt class="descclassname">riak.datatypes.</tt><tt class="descname">Counter</tt><big>(</big><em>bucket=None</em>, <em>key=None</em>, <em>value=None</em>, <em>context=None</em><big>)</big><a class="headerlink" href="#riak.datatypes.Counter" title="Permalink to this definition">¶</a></dt>
<dd><p>A convergent datatype that represents a counter which can be
incremented or decremented. This type can stand on its own or be
embedded within a <a class="reference internal" href="#riak.datatypes.Map" title="riak.datatypes.Map"><tt class="xref py py-class docutils literal"><span class="pre">Map</span></tt></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="riak.datatypes.Counter.value">
<tt class="descclassname">Counter.</tt><tt class="descname">value</tt><a class="headerlink" href="#riak.datatypes.Counter.value" title="Permalink to this definition">¶</a></dt>
<dd><p>The current value of the counter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="riak.datatypes.Counter.increment">
<tt class="descclassname">Counter.</tt><tt class="descname">increment</tt><big>(</big><em>amount=1</em><big>)</big><a class="headerlink" href="#riak.datatypes.Counter.increment" title="Permalink to this definition">¶</a></dt>
<dd><p>Increments the counter by one or the given amount.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>amount</strong> (<em>int</em>) &#8211; the amount to increment the counter</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="riak.datatypes.Counter.decrement">
<tt class="descclassname">Counter.</tt><tt class="descname">decrement</tt><big>(</big><em>amount=1</em><big>)</big><a class="headerlink" href="#riak.datatypes.Counter.decrement" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrements the counter by one or the given amount.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>amount</strong> (<em>int</em>) &#8211; the amount to decrement the counter</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="set">
<h2>Set<a class="headerlink" href="#set" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="riak.datatypes.Set">
<em class="property">class </em><tt class="descclassname">riak.datatypes.</tt><tt class="descname">Set</tt><big>(</big><em>bucket=None</em>, <em>key=None</em>, <em>value=None</em>, <em>context=None</em><big>)</big><a class="headerlink" href="#riak.datatypes.Set" title="Permalink to this definition">¶</a></dt>
<dd><p>A convergent datatype representing a Set with observed-remove
semantics. Currently strings are the only supported value type.
Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">myset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;barista&#39;</span><span class="p">)</span>
<span class="n">myset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;roaster&#39;</span><span class="p">)</span>
<span class="n">myset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;brewer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Likewise they can simply be removed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">myset</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="s">&#39;barista&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This datatype also implements the <a class="reference external" href="https://docs.python.org/2/library/collections.html">Set ABC</a>, meaning it
supports <tt class="docutils literal"><span class="pre">len()</span></tt>, <tt class="docutils literal"><span class="pre">in</span></tt>, and iteration.</p>
</dd></dl>

<dl class="attribute">
<dt id="riak.datatypes.Set.value">
<tt class="descclassname">Set.</tt><tt class="descname">value</tt><a class="headerlink" href="#riak.datatypes.Set.value" title="Permalink to this definition">¶</a></dt>
<dd><p>An immutable copy of the current value of the set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">frozenset</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="riak.datatypes.Set.add">
<tt class="descclassname">Set.</tt><tt class="descname">add</tt><big>(</big><em>element</em><big>)</big><a class="headerlink" href="#riak.datatypes.Set.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds an element to the set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>element</strong> (<em>str</em>) &#8211; the element to add</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="riak.datatypes.Set.discard">
<tt class="descclassname">Set.</tt><tt class="descname">discard</tt><big>(</big><em>element</em><big>)</big><a class="headerlink" href="#riak.datatypes.Set.discard" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes an element from the set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>element</strong> (<em>str</em>) &#8211; the element to remove</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="map">
<h2>Map<a class="headerlink" href="#map" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="riak.datatypes.Map">
<em class="property">class </em><tt class="descclassname">riak.datatypes.</tt><tt class="descname">Map</tt><big>(</big><em>bucket=None</em>, <em>key=None</em>, <em>value=None</em>, <em>context=None</em><big>)</big><a class="headerlink" href="#riak.datatypes.Map" title="Permalink to this definition">¶</a></dt>
<dd><p>A convergent datatype that acts as a key-value datastructure. Keys
are pairs of <tt class="docutils literal"><span class="pre">(name,</span> <span class="pre">datatype)</span></tt> where <tt class="docutils literal"><span class="pre">name</span></tt> is a string and
<tt class="docutils literal"><span class="pre">datatype</span></tt> is the datatype name. Values are other convergent
datatypes, represented by any concrete type in this module.</p>
<p>You cannot set values in the map directly (it does not implement
<tt class="docutils literal"><span class="pre">__setitem__</span></tt>), but you may add new empty values or access
non-existing values directly via bracket syntax. If a key is not in the
original value of the map when accessed, fetching the key will cause
its associated value to be created.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">map</span><span class="p">[(</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="s">&#39;register&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>Keys and their associated values may be deleted from the map as
you would in a dict:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">del</span> <span class="nb">map</span><span class="p">[(</span><span class="s">&#39;emails&#39;</span><span class="p">,</span> <span class="s">&#39;set&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>Convenience accessors exist that partition the map&#8217;s keys by
datatype and implement the <tt class="xref py py-class docutils literal"><span class="pre">Mapping</span></tt>
behavior as well as supporting deletion:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">map</span><span class="o">.</span><span class="n">sets</span><span class="p">[</span><span class="s">&#39;emails&#39;</span><span class="p">]</span>
<span class="nb">map</span><span class="o">.</span><span class="n">registers</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
<span class="k">del</span> <span class="nb">map</span><span class="o">.</span><span class="n">counters</span><span class="p">[</span><span class="s">&#39;likes&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="riak.datatypes.Map.value">
<tt class="descclassname">Map.</tt><tt class="descname">value</tt><a class="headerlink" href="#riak.datatypes.Map.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the original map&#8217;s value. Nested values are
pure Python values as returned by <a class="reference internal" href="#riak.datatypes.Datatype.value" title="riak.datatypes.Datatype.value"><tt class="xref py py-attr docutils literal"><span class="pre">Datatype.value</span></tt></a> from
the nested types.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="riak.datatypes.Map.counters">
<tt class="descclassname">Map.</tt><tt class="descname">counters</tt><a class="headerlink" href="#riak.datatypes.Map.counters" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters keys in the map to only those of counter types. Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">map</span><span class="o">.</span><span class="n">counters</span><span class="p">[</span><span class="s">&#39;views&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">increment</span><span class="p">()</span>
<span class="k">del</span> <span class="nb">map</span><span class="o">.</span><span class="n">counters</span><span class="p">[</span><span class="s">&#39;points&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="riak.datatypes.Map.flags">
<tt class="descclassname">Map.</tt><tt class="descname">flags</tt><a class="headerlink" href="#riak.datatypes.Map.flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters keys in the map to only those of flag types. Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">map</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="s">&#39;confirmed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
<span class="k">del</span> <span class="nb">map</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="s">&#39;attending&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="riak.datatypes.Map.maps">
<tt class="descclassname">Map.</tt><tt class="descname">maps</tt><a class="headerlink" href="#riak.datatypes.Map.maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters keys in the map to only those of map types. Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">map</span><span class="o">.</span><span class="n">maps</span><span class="p">[</span><span class="s">&#39;emails&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">registers</span><span class="p">[</span><span class="s">&#39;home&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;user@example.com&quot;</span><span class="p">)</span>
<span class="k">del</span> <span class="nb">map</span><span class="o">.</span><span class="n">maps</span><span class="p">[</span><span class="s">&#39;spam&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="riak.datatypes.Map.registers">
<tt class="descclassname">Map.</tt><tt class="descname">registers</tt><a class="headerlink" href="#riak.datatypes.Map.registers" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters keys in the map to only those of register types. Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">map</span><span class="o">.</span><span class="n">registers</span><span class="p">[</span><span class="s">&#39;username&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s">&quot;riak-user&quot;</span><span class="p">)</span>
<span class="k">del</span> <span class="nb">map</span><span class="o">.</span><span class="n">registers</span><span class="p">[</span><span class="s">&#39;access_key&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="riak.datatypes.Map.sets">
<tt class="descclassname">Map.</tt><tt class="descname">sets</tt><a class="headerlink" href="#riak.datatypes.Map.sets" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters keys in the map to only those of set types. Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">map</span><span class="o">.</span><span class="n">sets</span><span class="p">[</span><span class="s">&#39;friends&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;brett&quot;</span><span class="p">)</span>
<span class="k">del</span> <span class="nb">map</span><span class="o">.</span><span class="n">sets</span><span class="p">[</span><span class="s">&#39;favorites&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="map-only-datatypes">
<h2>Map-only datatypes<a class="headerlink" href="#map-only-datatypes" title="Permalink to this headline">¶</a></h2>
<p>Two of the new Data Types may only be embedded in
<a class="reference internal" href="#riak.datatypes.Map" title="riak.datatypes.Map"><tt class="xref py py-class docutils literal"><span class="pre">Map</span></tt></a> objects (in addition to
<a class="reference internal" href="#riak.datatypes.Map" title="riak.datatypes.Map"><tt class="xref py py-class docutils literal"><span class="pre">Map</span></tt></a> itself):</p>
</div>
<div class="section" id="register">
<h2>Register<a class="headerlink" href="#register" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="riak.datatypes.Register">
<em class="property">class </em><tt class="descclassname">riak.datatypes.</tt><tt class="descname">Register</tt><big>(</big><em>bucket=None</em>, <em>key=None</em>, <em>value=None</em>, <em>context=None</em><big>)</big><a class="headerlink" href="#riak.datatypes.Register" title="Permalink to this definition">¶</a></dt>
<dd><p>A convergent datatype that represents an opaque string that is set
with last-write-wins semantics, and may only be embedded in
<a class="reference internal" href="#riak.datatypes.Map" title="riak.datatypes.Map"><tt class="xref py py-class docutils literal"><span class="pre">Map</span></tt></a> instances.</p>
</dd></dl>

<dl class="attribute">
<dt id="riak.datatypes.Register.value">
<tt class="descclassname">Register.</tt><tt class="descname">value</tt><a class="headerlink" href="#riak.datatypes.Register.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the original value of the register.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="riak.datatypes.Register.assign">
<tt class="descclassname">Register.</tt><tt class="descname">assign</tt><big>(</big><em>new_value</em><big>)</big><a class="headerlink" href="#riak.datatypes.Register.assign" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns a new value to the register.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>new_value</strong> (<em>str</em>) &#8211; the new value for the register</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="flag">
<h2>Flag<a class="headerlink" href="#flag" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="riak.datatypes.Flag">
<em class="property">class </em><tt class="descclassname">riak.datatypes.</tt><tt class="descname">Flag</tt><big>(</big><em>bucket=None</em>, <em>key=None</em>, <em>value=None</em>, <em>context=None</em><big>)</big><a class="headerlink" href="#riak.datatypes.Flag" title="Permalink to this definition">¶</a></dt>
<dd><p>A convergent datatype that represents a boolean value that can be
enabled or disabled, and may only be embedded in <a class="reference internal" href="#riak.datatypes.Map" title="riak.datatypes.Map"><tt class="xref py py-class docutils literal"><span class="pre">Map</span></tt></a>
instances.</p>
</dd></dl>

<dl class="attribute">
<dt id="riak.datatypes.Flag.value">
<tt class="descclassname">Flag.</tt><tt class="descname">value</tt><a class="headerlink" href="#riak.datatypes.Flag.value" title="Permalink to this definition">¶</a></dt>
<dd><p>The current value of the flag.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool, None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="riak.datatypes.Flag.enable">
<tt class="descclassname">Flag.</tt><tt class="descname">enable</tt><big>(</big><big>)</big><a class="headerlink" href="#riak.datatypes.Flag.enable" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns the flag on, effectively setting its value to <tt class="docutils literal"><span class="pre">True</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="riak.datatypes.Flag.disable">
<tt class="descclassname">Flag.</tt><tt class="descname">disable</tt><big>(</big><big>)</big><a class="headerlink" href="#riak.datatypes.Flag.disable" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns the flag off, effectively setting its value to <tt class="docutils literal"><span class="pre">False</span></tt>.</p>
</dd></dl>

</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="query.html" class="btn btn-neutral float-right" title="Query Methods"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="object.html" class="btn btn-neutral" title="Values &amp; Objects"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2010-2014, Basho Technologies.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>